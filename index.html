<!DOCTYPE html>
<meta charset="UTF-8">
<meta name="viewport" content ="width=device-width,initial-scale=1,user-scalable=yes"/>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<html>
   <head>
      <title>Messenger</title>
   </head>
   
   <script src = "/socket.io/socket.io.js"></script>
   <script>
      var socket = io();
      function setUsername() {
         socket.emit('setUsername', document.getElementById('name').value);
      };
      var user;
      socket.on('userExists', function(data) {
         document.getElementById('error-container').innerHTML = data;
      });

      socket.on('userSet', function(data) {
         user = data.username;
        

      });


      function sendMessage() {
         
         var msg = document.getElementById('typewrite').value;
         if(msg==="") {
            alert("You didn't type anything!");
         }
         else {  socket.emit('msg', {message: msg, user: user}); 
         document.getElementById('typewrite').value="";}
      }

      function enterMessage() {
  var key = window.event.keyCode;

  // If the user has pressed enter
  if (key === 13) {
   var msg = document.getElementById('typewrite').value;
         if(msg==="") {
            alert("You didn't type anything!");
         }
         else {  socket.emit('msg', {message: msg, user: user}); 
         document.getElementById('typewrite').value="";
         }
      return false;
  }
  else {
      return true;
  }
}


      socket.on('newmsg', function(data) {
         if(user) {
            
            
            var Value= data.user + ': ' + data.message ; // ONOMA KAI MINIMA
            var p=document.createElement("p");
            var text=document.createTextNode(Value); //apothikeuw to text
            p.appendChild(text);
           document.getElementById("mylist").appendChild(p); 

           window.setInterval(function() {
         var elem = document.getElementById("mylist");
          elem.scrollTop = elem.scrollHeight;
           }, 4000);



            }
             })

            socket.on('newuser', function(data) {
               
               document.getElementById("usersonline");
         //h lista me tous online users
         var nameOfUser= data; // ONOMA user
            var li=document.createElement("li");
            var userlist=document.createTextNode(nameOfUser); //apothikeuw to text
            li.appendChild(userlist);
           document.getElementById("usersonline").appendChild(li); 

           window.setInterval(function() {
         var elem = document.getElementById("usersonline");
          elem.scrollTop = elem.scrollHeight;
           }, 4000); 
         
            })
            
         var getImage = function(event) {

  
        var image = document.getElementById('photoimage');
         image.src = URL.createObjectURL(event.target.files[0]);

         }
     
    

   </script>
   
    <style>
           

      body {background-repeat: no-repeat;
        background-image:url(https://scontent.fath5-1.fna.fbcdn.net/v/t31.0-8/s960x960/14372415_1654292254860965_7913107599425929631_o.png?_nc_cat=110&_nc_sid=8024bb&_nc_eui2=AeEzhRLG-peB6a0GAjngrMQz1rh9CwkY0gLWuH0LCRjSAmDjVl7JBFEl8lM0HDS5hxm-YZcaJaVwR3xQl628rw4F&_nc_ohc=tfQw73y6P_8AX_xJ8Xg&_nc_ht=scontent.fath5-1.fna&oh=5258a5f996dea5996274fce51fd52d3f&oe=5EBC7FEA);
        background-size: cover;
        background-position: center;
        
        
        }
   
    div.main {
                display: flex;
                flex-wrap: wrap;
                
               
                 } 

    div.col {flex-direction: column;
            flex: 25%;
            max-width: 25%; 
            height: 600px; 
            
                
            }
    
    
    
    h2{ margin-left: 22%;
        font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
        display: flex;
        text-shadow: 1px 2px #413649;
        color:#1b1b1b;
        
        
        }
    h3{ font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
        display: flex;
        margin-left: 10%;}

    div.box {border: outset 5px rgba(164, 133, 194, 0.76);
                flex: 100%;
                max-width: 100%; 
                height: 410px; 
                border-radius: 30px;
                 display: flex;   
                background-color: white;
                background-image: linear-gradient(to right, rgba(255,0,0,0), rgba(202, 122, 101, 0.534)); 
                justify-content: center;
                     
            }

            #Messagebox {
                background-color: white;
                background-image: linear-gradient(to right, rgba(255,0,0,0), rgba(190, 145, 241, 0.349));
            }

            

            

            .text::-webkit-scrollbar {
                width: 8px;
                height: 5px;
                padding-top: 10px;
            }

            .text::-webkit-scrollbar-thumb {
                
                border-radius: 20px;
                background: #c2c9d2;
            }


            
        div.col:nth-child(2) { flex-direction: column;
                            flex: 50%;
                            max-width: 50%;
                            height: 100%;
                            
                            }
    
    div.status  {flex-direction: column;
                height: 40%;
                display: flex;
                margin-left: 5%;
                }
    div.offline{ margin-top: 10px;
        display: flex;
        
        }

    .text { display: inline-block;
        display: flex;
        border: inset rgba(74, 53, 95, 0.76);
        
        padding: 0px 0px 40px 10px;
        border-radius: 20px;
        }
    
    
    

    .send + label {border-radius: 5px;
    font-weight: 0;
    color: black;
    background-color: rgb(136, 91, 173);
    display: inline-block;
    
    
    
    } 

    .send + label:hover { background-color: rgb(230, 179, 255);
    } 
    
    .inputfile, .photo,.voice, .settings, .call, .videocall, .send { 
    
	opacity: 1;
	overflow: visible;
	position: absolute;
    width: 3px;
	visibility: hidden;

    
    }

    label.status {font-family: 'Courier New', Courier, monospace;
            text-shadow: 0px 1px 1px black;
            font-size: 20px;
            }

    

    .inputfile + label, .photo + label, .voice + label, .settings + label, .call + label, .videocall + label {
    
    border-radius: 5px;
    font-weight: 0;
    color: black;
    background-color: rgb(136, 91, 173);
    display: inline-block;
}


.inputfile + label:hover, .photo + label:hover, .voice + label:hover, .settings + label:hover, .call + label:hover, .videocall + label:hover   {
    background-color: rgb(230, 179, 255); }

div.buttonsup { position: static;
                margin-left: 3px;
                
                 }
    
   

   div.buttonsdown {margin-top: -17px;
   height: 28px;
   
    } 
    .profileimage >input {display: none;

                        }
    .profileimage {display: flex;
                    justify-content: center;
                    width: 66%;
                    }

    .profileimage  label {width: 66%;}
    .profileimage img{ display: flex;
                        width: 90%;
                        max-width: 150px;
                        max-height:120px;
                        margin-top: 10px;}
    
   .online {display: flex;
            }
    
    #mylist {width: 100%;
                font-size: 20px;
                overflow: scroll;
                
                margin: 9px 2px 9px 0px;
                
                }
               p {width: 50%;
                overflow-y:wrap;
                word-wrap: break-word;
                padding-bottom: 40px;
                padding-left: 7px;
                   border-radius: 4px;
                }

                div.mylist::-webkit-scrollbar {
                width: 8px;
                height: 5px;
                padding-top: 10px;
            }

            div.mylist::-webkit-scrollbar-thumb {
                
                border-radius: 20px;
                background: #c2c9d2;
            }
            ul.onusers::-webkit-scrollbar {
                width: 8px;
                height: 5px;
                padding-top: 10px;
            }

            ul.onusers::-webkit-scrollbar-thumb {
                
                border-radius: 20px;
                background: #c2c9d2;
            }

            ul.onusers {
               width: 100%;
               overflow: scroll;
               
            }

           ul li { font-size: 25px;
                  cursor: pointer;
                  font-weight: bold;
                  margin-top: 7px;}
            
           p {font-size: 25px;}
    </style>
<title>Messenger</title>
</head>




    <body>
    <div class="main">
    <div class="col"><h2>Me</h2>
    <div class="box" >
        <div class="profileimage">
        <label for="filephoto" style="cursor: pointer;"><i>Click to upload</i>
            
            <img id="photoimage" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAANlBMVEX////Fx8nBw8Xd3uDi4+TGyMr6+vry8/PLzc/t7u7k5ebg4eL39/jo6erJy8309PXY2dvR09QXDCJbAAAEXElEQVR4nO2d2XarMAxFy1CmMOX/f/ZC4FKSUIJtCR26zn7qQxdlL8uyLWz364sQQgghhBBCLkWWN9UtSZJb1eSZ9ctIkzV9EQ9EE+OPRd/8Gc0uaRe3NXHcJp31ywlQtVt2i2VbWb9gGFm/pzdL9teN1iN+l3ZMj/k9HFPrl/Wg2+1/b4rt5XLOzcXv4XizfmU3ClfBQbGwfmkHame9idr6xY+Suzfg3Iyl9asfo/QVvIpigOA1FL1DdFbMrQU+kYUJDoro6eY7UHDAWmGfe7hgdLeW2KMKjdER5ElqcCecFXG7YiEiGEWw87dGpgmHRkRd+Av5jYrWKtvc5AyjxFpmE6kYHYFsxFRQELMRRQURZzZBS4p34sZa6A2J+doavDFRtgmHRkSroYqN9gtoo750kOItMcSbEG1IDKxdbBpilWwqccEowlom9gqGWB1RamW45tta6gn5bgiWaoTKFy+GSMWMWsUQqTisMFiADRfCC4vZEGl5QUMa0tCev59LdcZDqC02KoZQdQwFQax5qUIRA63aligY9tZST8iX2rAGC5XlE9Ti6UtkD8Yr1kovyHdErG6oMG+DmtE8EBYEGw1HpMMULUjFp6ZQRZoZ2ZIp1oRmQjTXgA33M62gIVa9+z+CjYjZhJILDMReOCKWTrFW92sSIUW8sXBBJtlgppkJkTjFjdERgW3QyJugRw4eqtwB6+P2BqGTN9SBYkVYtkHOMgshipcQDFFsrV/9KHe/dHOlU6ReGTUGnsq841EhRl1P/EbtdFh9PK4OVgA+gNN59audVZ/IDiec+A71qdCB/JBjXADW1Q7z2TG+X9lvJEt3ck78nV41Pp+o0/vGJUNxXKTXy5+/k1d98bgf6kFU9NXVg3ObrK67uv4TgUkIIYQQQsCp87KpqtSdqmrKHHu1sVo/HFjab6wWodcdZVJ4em27FgnUvrayF7T7sexBJDsNvUXS/ntw6XHLpZNkYduQpWNl28uxtXPslNtvcSyMYjX8k/1xR4vPUuVpehOnh6rU9qfDxCffq3RSD3xSPPMLse89waGcNmlVOU95hLM2f5sJnqXY2Qmes6tP5QoMB0X9jx4KR7icUN81pXFY1A3lvYsO/9FBC93LTVVOpbuievRS47IkdxQnNwqnfX1Q3B9mrbagJSh5jW4YWnvEMGJ0ROmAqciF6zIojRjWs5k1KjMblVt2fFE56a1xNaI/GqUppCZUyTVQQaoSphr3s4QgX3rDmJL+ID85xQpShY5oWH7aRrwoBTShmRBfYKAlGvlUY1+feUW6XoOWSuWTqbXPBsKGaIlGfrig4fnQkIY0tIeGNKShPTSkIQ3toSENafjy13yPyXx45t5DTzWsygHhD6jx+My9zR9nGk7lZ2nD8Zl72wRpSEMa0pCGNKQhDWlIQxrSkIY0pCENaUhDGtKQhjSkIQ1pSEMa0pCGNKTh74aygucbJnvUH3/Dg4fhp18ghBBCCCGEkJP4B3ymXHSpa16yAAAAAElFTkSuQmCC" />
            </label>
            
            <input id="filephoto"  type="file"  accept="image/*" onchange="getImage(event)" />
            
        </div> </div>
        
        
    
    
    
        <h3>Status</h3>
        <div class="status">
        <div class="online"><input type="radio" id="online" class="online" name="status" value="online" checked> 
        <label for="online" class="status">Online</label></div>
        <div class="offline"><input type="radio" id="offline" class="offline" name="status" value="offline"> 
        <label for="offline" class="status">Offline</label></div>
    </div></div>
    <div class="col">
    <div class="buttonsup" style="margin-top: 39px ;">
        
        <input type="button" class="settings" id="Settings" value="Settings" >
        <label for="Settings"><i class="material-icons">settings</i></label>
        <input type="button" class="call" id="Call" value="Call">
        <label for="Call"><i class="material-icons">call</i></label>
        <input type="button" class="videocall" id="Videocall" value="Videocall">
        <label for="Videocall"><i class="material-icons">video_call</i></label>
    </div>   
    <div class="box" id="Messagebox"> 
        <div id="mylist" class="mylist"  >

        </div></div>
    
    
    <div id = "error-container"></div>
      <div id="chatting">
      <input id = "name" type = "text" name = "name" value = "" 
         placeholder = "Enter your name!">
      <button type = "button" name = "button" onclick = "setUsername()">
         Let me chat!
      </button>
      </div>
    <textarea rows="2" cols="20" wrap="hard" class= "text" id="typewrite" onkeypress="enterMessage();" placeholder="Write a message..." value="" style="width: 100%;" ></textarea><br>
    <div class="buttonsdown"> 
    <input type="file" name="file" id="file" class="inputfile" multiple />
        <label for="file"><i class="material-icons">attach_file</i></label>
        <input type="file" class="photo" id="photo" value="Photo" multiple >
        
    
        <label for="photo"> <i class="material-icons">photo_camera</i></label>
        <input type="button" class="voice" id="voice" value="Voice">
        <label for="voice"> <i class="material-icons">mic</i></label>
        <input type="button" onclick="sendMessage()" class="send" id= "SEND" value="Send" >
        <!--<script src="pressenter.js"></script> -->
        
        <label for="SEND" ><i class="material-icons" >send</i></label>
        </div></div>
    <div class="col"><h2>Online Users</h2>
     
        <div class="box" id="OnlineUsers">
         <ul id="usersonline" class="onusers"  >

         </ul>
            
                
            </div> </div>
    
    
    </div></div>

    






</div>
</body>
</html>